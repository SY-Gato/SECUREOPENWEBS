<!DOCTYPE html>
<html>
  <head>
    <title>Redirecting...</title>
    <style>
      body {
        text-align: center;
      }
    </style>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const searchParams = new URLSearchParams(location.search);
        //alert(searchParams.entries());
        if (searchParams.has("url") && searchParams.get("url") != null) {
          let spec = atob(searchParams.get("url")).toString();
          let target;
          let start = "https://";
          if (!spec.startsWith("https://") && !spec.startsWith("http://")) {
            target = start.concat(spec);
          } else {
            target = spec;
          }
          setTimeout(function() {
            /*let spec = atob(searchParams.get("url")).toString();
            let target;
            let start = "https://";
            if (!spec.startsWith("https://") && !spec.startsWith("http://")) {
              target = start.concat(spec);
            } else {
              target = spec;
            }*/
            window.location = target;
            /*let a = document.createElement("a");
            a.href = target;
            a.target = "_blank";
            a.click();
            window.close();*/
            //window.location.href = target.toString();
            //window.location = target;
            
          }, 500);
          setTimeout(function() {
            let item = document.createElement("button");
            //item.href = target;
            //item.target = "_self";
            item.innerHTML = "Not redirecting? Click here.";

            item.addEventListener("click", function() {
              window.location.href = target;
            });
            document.body.appendChild(item);
          }, 500);
        } else {
          let el = document.getElementById("thingy");
          el.style.color = "red";
          el.innerHTML = "ERROR! 'url' Parameter not found!";
        }
        /*alert("hi");
        const targ = new URLSearchParams(location.search).get("url");
        alert(targ.toString());
        location.href = targ;*/
      });
    </script>
  </head>
  <body>
    <h1 id="thingy">
      REDIRECTING...
    </h1>
  </body>
</html>
